## 交互改动
- 上传后自动解析并展示预览与质量概览，但不立即入库。
- 在“上传数据”页的解析结果下方新增两个动作按钮：
  - 入库：仅当质量错误占比≤阈值（默认 5%）时可入库。
  - 强制入库：即使质量检测有问题也允许入库，且计算并累计条目数量。
- 入库成功后即时提示：显示本次入库的类型与条目数；页面自动刷新以更新顶部进度指标与条形图。
- 进度展示：延用现有的问答对/习题数量与目标进度条，入库后立即刷新显示当前进度。
- 适用范围：问答对与习题库两类，均支持“入库/强制入库”。

## 技术实现
- 修改 `app.py` 的“上传数据”分支（约 126–163 行）：
  - 保持 `archive_raw_file(uploaded, college)` 与 `parse_uploaded_file` 逻辑不变。
  - 使用 `meta.get("quality_summary")` 获取错误行占比 `error_row_ratio` 和总条目数 `len(df)`。
  - 在解析结果区域下添加按钮：
    - 当 `error_row_ratio <= 0.05` 时显示“入库”按钮；点击后调用 `save_parsed_dataset(df, meta, user_info["college"])`，成功后 `st.success` 并 `st.rerun()`。
    - 总是显示“强制入库”按钮；点击后无视阈值调用 `save_parsed_dataset` 并刷新进度。
  - 入库提示文案包含：文件名、类型（问答对/习题库）、本次入库条目数。
- 质量阈值：在 `app.py` 顶部或“上传数据”块内定义常量 `QUALITY_ERROR_RATIO_THRESHOLD = 0.05` 以便后续调整。
- 不改动 `modules/storage` 与入库文件结构；历史记录与汇总统计使用现有 `list_parsed_datasets`、`load_csv` 等已自动反映入库结果。
- 不改动质量检测模块；沿用现有 `assess_qa/assess_exercises/summarize_quality` 输出。

## 代码插入点
- `app.py`：
  - 在“上传数据”分支解析后（约 `render_tabs(df, meta, ...)` 之后）插入：
    - 计算 `err_ratio = meta.get("quality_summary", {}).get("error_row_ratio", 0.0)`。
    - 渲染“入库”与“强制入库”按钮；触发调用 `save_parsed_dataset(...)`。
    - 成功后执行 `st.rerun()` 或 `st.experimental_rerun()`。
- 其他页面（历史记录/测试样例）无需更改即可显示最新数量与预览。

## 验证方案
- 用健康样例上传，点击“入库”，验证提示与进度更新，历史记录新增条目，条目数正确。
- 用存在较多错误的样例上传，观察“入库”禁用或提示，点击“强制入库”，验证仍能入库并计数；进度刷新正确。
- 分别测试问答对与习题库，确保两类条目数统计与历史预览一致。

## 风险与兼容
- 解析后按钮仅在 `uploaded is not None` 且解析成功时出现，不影响其他流程。
- 未使用会话持久化存储 DataFrame，按钮与变量在同一执行上下文即可完成入库，避免状态复杂度。
- 若后续需要批量入库或撤销入库，可在 `modules/storage` 层增扩对应接口。