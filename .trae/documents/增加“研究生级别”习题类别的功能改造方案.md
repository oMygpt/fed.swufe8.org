## 核心思路
- 在现有“习题库”数据结构中新增维度 `level`（取值：本科/研究生）。
- 上传时允许用户选择级别，系统也能基于文件/Sheet名进行自动识别并提示不一致。
- 所有统计、管理、质量检测与导出支持按级别区分与汇总。

## 数据结构与解析
- DataFrame新增字段：`level`（字符串），默认“本科”。
- 解析逻辑（modules/parsing.py）：
  1. 新增参数 `exercise_level`（用户选择）与自动识别函数（Sheet/文件名含“研究生/硕士/graduate”等关键词）。
  2. `meta` 中增加 `level`、`detected_level` 与一致性提示。
  3. 将 `level` 写入解析结果（CSV），用于后续统计与导出（质量信息仍仅用于页面展示，不写入文件）。

## 存储与索引
- 存储（modules/storage.py）：
  - 解析文件命名加入级别后缀，如 `*_parsed_ex_grad.csv` / `*_parsed_ex_ug.csv`。
  - `list_parsed_datasets` 返回时增加 `level` 字段，便于前端筛选。
  - 合并与历史方法兼容新命名与字段。

## 上传与历史界面
- 上传数据页（app.py）：
  - 在“习题库”模式下新增“级别”选择（本科/研究生），默认本科；支持“自动识别”。
  - 概览显示级别与不一致提示（选择 vs 自动识别）。
  - 入库前质量红线判断按级别规则执行（详见质量部分）。
- 历史记录：
  - 每条解析记录显示级别；支持按级别过滤或分组（可先列表中展示级别列）。
  - 删除与刷新统计不变，但统计依据新增按级别区分。

## 管理员面板（统计与管理）
- 汇总统计：
  - 增加“级别过滤（本科/研究生/全部）”；
  - 表格新增列：本科习题数、研究生习题数及各自目标与状态；质量均分与红色比例也按级别分项展示（或在详情中展示）。
- 学院管理：
  - 目标设置扩展为按级别与题型：如 `本科：选择/填空/…` 与 `研究生：选择/填空/…`；总目标也分级别设置。
  - 提供质量摘要：本科与研究生分项的质量均分、红色比例。

## 质量检测（按级别差异化）
- 规则仍按字段维度（stem/options/answer/knowledge），但权重可按级别调整：
  - 研究生级别更严格（例如选项缺失扣分更高、答案不在选项视为 Error 而非 Warn、知识点缺失强制 Error）。
- 入库红线统一：红色问题比例 > 5% 拒绝入库；提示“修复建议”列表按级别与错误类型生成。

## 导出
- 汇总输出支持按级别导出：
  - CSV：分别导出本科/研究生习题CSV；
  - Excel：每级别按题型分Sheet，如“本科-选择题”、“研究生-选择题”等。

## 配置与可调参数
- 新增配置（可选）：`config/quality.yaml`：
  - 级别与题型的权重与阈值（便于后续策略调整）。
- 目标配置 `config/targets.yaml` 扩展结构：
  - `targets[college].levels.ug/ex/...` 与 `types` 内分级别目标。

## 迁移与兼容
- 既有解析文件默认视为“本科”；
- 提供一次性迁移脚本（可选），根据目录或历史规则打标级别。

## 测试保障
- 单元测试新增：
  - 级别传递（上传选择/自动识别）与一致性提示。
  - 级别对质量评分与红线判定的影响。
  - 级别维度的统计与导出正确性。

## 实施步骤
1. 扩展解析与存储：加入级别字段与后缀命名，`meta` 返回 `level/detected_level`。
2. 更新上传页：级别选择与概览提示；入库红线判断按级别执行。
3. 更新汇总统计与学院管理：级别过滤、目标设置与质量分项展示。
4. 扩展导出：按级别与题型组织输出。
5. 引入可选质量配置；编写单测与回归验证。

请确认以上方案，确认后我将开始按步骤改造并交付。