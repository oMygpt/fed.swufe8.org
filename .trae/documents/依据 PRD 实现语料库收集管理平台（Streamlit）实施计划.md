## 项目结构
- 根目录：`app.py`（入口）、`pages/`（多页：上传、历史、管理员）、`modules/`（解析、存储、鉴权）、`storage/`、`exports/`、`config/`
- 模块划分：
  - `modules/auth.py`：登录与角色鉴权（学院用户/管理员）
  - `modules/parsing.py`：Excel/CSV 解析、Sheet 类型识别、字段归一化、校验
  - `modules/storage.py`：原始文件归档、结构化数据缓存（SQLite/CSV）、合并导出
  - `modules/ui.py`：组件与页面片段（概览、抽检、分页、搜索）
  - `modules/utils.py`：通用工具（编码检测、文件名清理、日志）

## 技术栈与依赖
- 前端框架：Streamlit
- 数据处理：Pandas、OpenPyXL（xlsx）、csv 标准库
- 鉴权：`streamlit-authenticator`（YAML 用户配置）
- 存储：SQLite（解析缓存）+ 文件系统（原始/导出）
- 其他：`python-dateutil`（日期）、`chardet`（CSV 编码识别，可选）

## 认证与角色
- 预置 6 个学院账号 + 1 管理员账号，存于 `config/users.yaml`（哈希密码）
- 登录后在 Sidebar 显示当前用户与学院；基于角色渲染功能菜单
- 管理员可查看所有学院上传记录、导出合并数据

## 上传与模板
- 页面提供《问答对模板.xlsx》《习题库模板.xlsx》下载（静态模板文件）
- 上传支持：`.xlsx`/`.xls`/`.csv`，限制大小与后缀白名单
- 文件名清理并归档到：`storage/<college>/<YYYY-MM-DD>/<filename>`（保留原始）

## 解析与校验
- Excel 多 Sheet 遍历：若 Sheet 名包含“选择/填空/问答”等，标记类型；否则读取“题型”列
- QA 归一化：字段映射 `question/问题/问/Q` → `question`，`answer/答案/答/A` → `answer`
- 习题归一化：生成标准表字段 `type/stem/options/answer/knowledge/analysis`
- 列名不符合预期标红警告；缺必填列阻断并给出修复建议
- 数据清洗：去空行、去重、修复常见偏移（可选）

## 预览与抽检
- 概览信息：文件名、包含 Sheet、识别列名、高亮异常列、有效条目总数
- 抽检 Tab：
  - `随机抽检（20）`：`DataFrame.sample(20)`
  - `顺序浏览`：全量分页（Streamlit 原生或自定义分页）
  - 简单搜索：关键词过滤、校验案例（如“答案为空”）

## 存储与导出
- 原始文件：按学院/日期/文件名归档
- 结构化数据：写入 SQLite 表（按学院与日期分区）或缓存至 CSV
- 管理员合并：跨学院/日期一键合并并导出 `exports/merged.csv`（带去重与基本校验）

## 管理员功能
- 总览：各学院上传次数、最近上传时间、数据量统计
- 内容查看：按学院与日期分页浏览解析结果
- 导出：下载合并后的清洗数据（CSV）
- 账号管理：支持重置密码（更新 YAML）

## 错误处理与日志
- 上传失败/解析失败：明确提示与可操作修复建议
- 编码识别与异常行定位：显示问题行索引与列名
- 操作日志：写入本地日志文件，记录上传、解析、导出动作

## 部署方案
- 开发：本地直接运行 `streamlit run app.py`
- 生产：Docker 容器化，挂载 `storage/` 与 `exports/` 持久化卷；环境变量控制配置路径

## 验收标准
- 能完成登录与角色区分；学院用户可上传并看到概览与抽检
- QA/习题两类均能正确识别与归一化；异常列与缺失必填清晰提示
- 原始文件与结构化数据按学院/日期归档；管理员能合并导出

## 下一步实施（代码里程碑）
1. 初始化项目结构与依赖，落地 `config/users.yaml`
2. 完成登录与角色菜单渲染（Sidebar）
3. 实现上传、归档与基础解析（含多 Sheet 识别）
4. 落地概览与抽检 UI，分页与搜索
5. 写入 SQLite/CSV 缓存、管理员合并导出
6. 打包 Docker 与基础运维配置

请确认以上实施计划；确认后我将开始搭建项目与编码实现。