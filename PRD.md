# 产品需求文档 (PRD) - 语料库收集管理平台

## 1. 项目背景与目标
- 背景：需要收集六个学院（经济、国商、金融、西部、财税、经管）的教学语料，用于后续的大模型训练或知识库构建。
- 目标：搭建一个轻量级 Web 平台，允许各学院独立登录上传 Excel/CSV 数据，系统自动解析并展示统计信息及抽样内容，确保数据符合格式要求。
- 核心痛点：手动通过微信/邮件收集文件容易混乱，且难以快速检查数据格式是否正确（如是否缺列、乱码等）。

## 2. 用户角色 (User Roles)
### 角色权限描述
#### 学院用户 (College User)
- 1. 登录（仅限自己的账户）
- 2. 上传问答对/习题文件
- 4. 查看自己已上传文件的解析结果（列名、行数、预览）
- 5. 删除/重新上传

#### 管理员 (Admin)
- 1. 管理学院账户（重置密码等）
- 2. 查看所有学院的提交状态和内容
- 3. 导出/下载汇总后的清洗数据

## 3. 业务流程图 (High-Level Flow)
- 登录 -> 选择 上传类型 (问答对 / 习题库) -> 拖拽上传 Excel/CSV。
- 后端解析 -> 检查文件格式 -> 读取 Sheet -> 识别列名。
- 前端反馈 -> 显示“成功识别 N 条数据” -> 显示列名清单。
- 数据校验 -> 展示随机 20 条 + 分页查看全部 -> 用户确认无误 -> 归档存储。

## 4. 功能需求详情 (Functional Requirements)
### 4.1 登录模块
- 预设账户：系统后台预置 6 个账号（例如：user_economy, user_finance 等），分发给对应学院接口人。
- 无需注册：为保证安全和管理方便，不开放注册功能。

### 4.2 数据上传模块 (核心)
- 文件上传：支持格式：.xlsx, .xls, .csv。
- 习题多Sheet处理逻辑：系统需遍历 Excel 中所有的 Sheet。如果 Sheet 名包含“选择”、“填空”、“问答”等关键词，自动标记该批数据的类型；如果是一个大表，则依赖表内的“题型”列。

### 4.3 数据解析与预览模块 (Data Parsing & View)
- 这是你需求中强调的重点，需分为统计和内容两部分。

#### A. 概览信息 (Meta Data)
- 上传成功后，页面顶部立即显示：
  - 文件名：例如 金融学院_期末题库.xlsx
  - 包含 Sheet：例如 Sheet1, 选择题
  - 识别到的列名 (Columns)：例如 ["题干", "选项A", "选项B", "答案"] （如果列名不符合预期，标红警告）。
  - 有效条目总数 (Total Count)：例如 1,058 条。

#### B. 内容抽检 (Content Inspection)
- 提供两个 Tab 标签页切换查看：
  - Tab 1: 随机抽检 (Random 20)
    - 逻辑：从上传的数据帧 (DataFrame) 中 sample(20)。
    - 目的：快速检查是否有乱码、错行、格式偏移。
  - Tab 2: 顺序浏览 (Sequential View)
    - 逻辑：展示完整数据表，支持翻页 (Pagination)。
    - 功能：支持简单的关键词搜索（例如搜“答案”为空的行）。

### 4.4 数据存储与导出
- 上传的文件在服务器端按 学院/日期/文件名 的结构归档保存。
- 解析后的结构化数据存入 SQLite 或 CSV 缓存，方便管理员一键合并。

## 5. 数据结构标准 (Data Schema)
- 为了让 Python 能够准确读取，建议制定如下“软标准”（即允许一定的列名别名，但核心要素必须有）。

### 5.1 问答对 (QA Pairs)
- 字段名 (Code) 显示名 (Display Name) 必填 备注
- question 问题 / 问 / Q 是
- answer 答案 / 答 / A 是 支持长文本

### 5.2 习题库 (Exercises)
- 考虑到习题的复杂性，建议统一为一个大表结构（Standard Flat Table）：
- 字段名 (Code) 建议列名 必填 说明
- type 题型 是 枚举值：选择、填空、判断、简答、案例分析
- stem 题干 / 问题描述 是 题目主要内容
- options 选项 否 选择题必填。格式建议：JSON或特定分隔符（如 "A: xxx\nB: xxx"）
- answer 正确答案 是 选择题填 "A"，填空题填内容
- knowledge 知识点 否 关联的课程章节或概念
- analysis 解析 否 题目的详细解答过程

## 6. 技术栈推荐 (Tech Stack)
- 考虑到你要快速开发且主要处理 Excel/Dataframe，强烈推荐使用 Streamlit。它不需要写 HTML/CSS/JS，纯 Python 即可生成漂亮的 Web 界面。
- 前端/框架: Streamlit (极其适合数据应用)
- 数据处理: Pandas (处理 Excel/CSV 的神器)
- 鉴权: Streamlit-Authenticator (简单的 YAML 配置文件管理 6 个用户)
- 部署: Docker 或直接在服务器运行 `streamlit run app.py`

## 7. 界面原型草图 (UI Mockup Description)
- Sidebar (左侧边栏)
  - Logo / 标题
  - 当前用户：经济学院 (Logout)
  - 菜单：[上传数据] [历史记录]
- Main Area (主区域)
  - Step 1: 准备数据
    - [按钮: 下载标准模板.xlsx]
  - Step 2: 上传文件
    - [Drag and drop file here] (上传后显示进度条...)
  - Step 3: 数据概览
    - Alert: "✅ 解析成功！[... 130 chars omitted ...]"
